<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunar Cycle Explorer</title>
    <style>
        :root {
            --bg-color: #0b0d17;
            --card-bg: #161b22;
            --text-color: #e6edf3;
            --accent: #58a6ff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            margin: 0;
        }

        .controls {
            margin-bottom: 30px;
            text-align: center;
        }

        select {
            padding: 10px;
            border-radius: 5px;
            background: var(--card-bg);
            color: white;
            border: 1px solid #30363d;
            font-size: 1rem;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            width: 100%;
            max-width: 1000px;
        }

        .day-card {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #30363d;
            transition: transform 0.2s;
        }

        .day-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
        }

        .date-label {
            font-size: 0.8rem;
            color: #8b949e;
            margin-bottom: 8px;
        }

        .moon-emoji {
            font-size: 2.5rem;
            margin: 10px 0;
            display: block;
        }

        .phase-name {
            font-size: 0.9rem;
            font-weight: bold;
        }

        .today {
            border: 2px solid var(--accent);
            box-shadow: 0 0 15px rgba(88, 166, 255, 0.3);
        }
    </style>
</head>
<body>

    <h1>Lunar Phase Calendar</h1>

    <div class="controls">
        <label for="city-select">Select City: </label>
        <select id="city-select">
            <option value="northern" selected>Shanghai (Northern Hemisphere)</option>
            <option value="southern">Sydney (Southern Hemisphere)</option>
            <option value="northern">Los Angeles (Northern Hemisphere)</option>
            <option value="northern">London (Northern Hemisphere)</option>
            <option value="southern">SÃ£o Paulo (Southern Hemisphere)</option>
        </select>
        <p id="location-note">Showing phases as seen from the Northern Hemisphere.</p>
    </div>

    <div class="calendar-grid" id="calendar"></div>

    <script>
        const LUNAR_MONTH = 29.530588853;

        // Simplified Julian Date calculation
        function getJulianDate(date) {
            return (date.getTime() / 86400000) - (date.getTimezoneOffset() / 1440) + 2440587.5;
        }

        function getMoonPhase(date, hemisphere) {
            // Reference New Moon: Jan 6, 2000
            const jd = getJulianDate(date);
            const daysSinceNew = (jd - 2451550.1) % LUNAR_MONTH;
            const age = daysSinceNew < 0 ? daysSinceNew + LUNAR_MONTH : daysSinceNew;
            
            let phase, emoji;

            if (age < 1.84566) { phase = "New Moon"; emoji = "ðŸŒ‘"; }
            else if (age < 5.53699) { phase = "Waxing Crescent"; emoji = "ðŸŒ’"; }
            else if (age < 9.22831) { phase = "First Quarter"; emoji = "ðŸŒ“"; }
            else if (age < 12.91963) { phase = "Waxing Gibbous"; emoji = "ðŸŒ”"; }
            else if (age < 16.61096) { phase = "Full Moon"; emoji = "ðŸŒ•"; }
            else if (age < 20.30228) { phase = "Waning Gibbous"; emoji = "ðŸŒ–"; }
            else if (age < 23.99361) { phase = "Last Quarter"; emoji = "ðŸŒ—"; }
            else if (age < 27.68493) { phase = "Waning Crescent"; emoji = "ðŸŒ˜"; }
            else { phase = "New Moon"; emoji = "ðŸŒ‘"; }

            // Flip emojis for Southern Hemisphere
            if (hemisphere === "southern") {
                const southernEmojis = {
                    "ðŸŒ’": "ðŸŒ˜", "ðŸŒ“": "ðŸŒ—", "ðŸŒ”": "ðŸŒ–",
                    "ðŸŒ–": "ðŸŒ”", "ðŸŒ—": "ðŸŒ“", "ðŸŒ˜": "ðŸŒ’"
                };
                emoji = southernEmojis[emoji] || emoji;
            }

            return { phase, emoji };
        }

        function renderCalendar() {
            const calendarEl = document.getElementById('calendar');
            const hemisphere = document.getElementById('city-select').value;
            calendarEl.innerHTML = '';
            
            const today = new Date();

            for (let i = 0; i < 28; i++) {
                const currentDate = new Date();
                currentDate.setDate(today.getDate() + i);
                
                const { phase, emoji } = getMoonPhase(currentDate, hemisphere);
                
                const card = document.createElement('div');
                card.className = `day-card ${i === 0 ? 'today' : ''}`;
                
                const dateString = currentDate.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
                const dayName = i === 0 ? "Today" : currentDate.toLocaleDateString(undefined, { weekday: 'short' });

                card.innerHTML = `
                    <div class="date-label">${dayName}, ${dateString}</div>
                    <span class="moon-emoji">${emoji}</span>
                    <div class="phase-name">${phase}</div>
                `;
                calendarEl.appendChild(card);
            }

            document.getElementById('location-note').innerText = 
                `Showing phases as seen from the ${hemisphere.charAt(0).toUpperCase() + hemisphere.slice(1)} Hemisphere.`;
        }

        document.getElementById('city-select').addEventListener('change', renderCalendar);
        
        // Initial build
        renderCalendar();
    </script>
</body>
</html>
